<!DOCTYPE html><html class="no-js" lang="es-ES"><head><meta http-equiv="content-type" content="text/html" charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" ><link rel="profile" href="http://gmpg.org/xfn/11"><link type="text/css" media="all" href="https://mierda.tv/wp-contenido/cache/autoptimize/css/autoptimize_dcbc99a7d03052a28dbf604173960da0.css" rel="stylesheet" /><title>SDL en C bajo GNU/Linux 004 &#8211; Varias imágenes y animación &#8211; [ MIERDA TV ]</title><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Feed" href="https://mierda.tv/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; RSS de los comentarios" href="https://mierda.tv/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; SDL en C bajo GNU/Linux 004 &#8211; Varias imágenes y animación RSS de los comentarios" href="https://mierda.tv/2017/05/02/sdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion/feed/" /><link rel='stylesheet' id='mcluhan-fonts-css'  href='https://fonts.googleapis.com/css?family=Archivo:400,400i,600,600i,700,700i&#038;subset=latin-ext' type='text/css' media='all' /> <script type='text/javascript' src='https://mierda.tv/wp-includes/js/jquery/jquery.js'></script> <link rel='https://api.w.org/' href='https://mierda.tv/wp-json/' /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mierda.tv/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mierda.tv/wp-includes/wlwmanifest.xml" /><link rel='prev' title='SDL en C bajo GNU/Linux 003 &#8211; Mostrando una imagen' href='https://mierda.tv/2017/05/02/sdl-en-c-bajo-gnulinux-003-mostrando-una-imagen/' /><link rel='next' title='Convertir un vídeo a gif y optimizar este luego' href='https://mierda.tv/2017/05/02/convertir-un-video-a-gif-y-optimizar-este-luego/' /><meta name="generator" content="WordPress 4.9.8" /><link rel="canonical" href="https://mierda.tv/2017/05/02/sdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion/" /><link rel='shortlink' href='https://mierda.tv/?p=2617' /><link rel="alternate" type="application/json+oembed" href="https://mierda.tv/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmierda.tv%2F2017%2F05%2F02%2Fsdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion%2F" /> <script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script> <link rel="icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon-1.png" type="image/png"/><link rel="shortcut icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon.png" /></head><body class="post-template-default single single-post postid-2617 single-format-standard"><header class="site-header group"><h1 class="site-title"><a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></h1><p class="site-description">NSFW Fanta text files</p><div class="nav-toggle"><div class="bar"></div><div class="bar"></div></div><div class="menu-wrapper"><ul class="main-menu desktop"><li id="menu-item-9007" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li id="menu-item-9006" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li id="menu-item-9008" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li id="menu-item-9012" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li id="menu-item-9011" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li id="menu-item-9010" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li></ul></div><ul class="social-menu desktop"><li><a href="https://mierda.tv/?s="></a></li><li id="menu-item-10588" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></header><div class="mobile-menu-wrapper"><ul class="main-menu mobile"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li><li class="toggle-mobile-search-wrapper"><a href="#" class="toggle-mobile-search">Buscar</a></li></ul><ul class="social-menu mobile"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></div><div class="mobile-search"><div class="untoggle-mobile-search"></div><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab60c780853"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab60c780853" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form><div class="mobile-results"><div class="results-wrapper"></div></div></div><div class="search-overlay"><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab60c7808e7"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab60c7808e7" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form></div><main class="site-content"><article class="post-2617 post type-post status-publish format-standard hentry category-juegos tag-animacion tag-c tag-gnu tag-linux tag-sdl tag-sprite tag-tutorial missing-thumbnail"><header class="entry-header section-inner"><h1 class="entry-title">SDL en C bajo GNU/Linux 004 &#8211; Varias imágenes y animación</h2><div class="meta"> <time><a href="https://mierda.tv/2017/05/02/sdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion/" title="2 mayo, 2017 3:05 pm">2 mayo, 2017</a></time> <span> En <a href="https://mierda.tv/category/juegos/" rel="category tag"># GAMES</a> </span></div></header><div class="entry-content section-inner"><p><img src="https://mierda.tv/wp-contenido/uploads/2017/05/sprite8.gif" alt="" width="400" height="250" class="alignnone size-full wp-image-2621" /><br /> &nbsp;<br /> Mostrar una imagen fue lo que vimos en el anterior post sobre SDL en C bajo GNU/Linux. En esta ocasión vamos a mostrar 2 imágenes. Una de fondo y otra que es un sprite con el que vamos a jugar para crear una animación de una persona andando.<br /> &nbsp;<br /> &nbsp;<br /> Para que no tengas que picar mucho código y crear estructuras de directorios he<strong> empaquetado en un zip </strong>todo el tinglado: <a href="https://mierda.tv/wp-content/uploads/2017/05/mostrarimagen.zip">mostrarimagen.zip</a><br /> &nbsp;<br /> &nbsp;<br /> Descargando ese zip no tendréis que andar bajando nada, no obstante voy a colocar las 2 imágenes que necesitaremos:<br /> &nbsp;<br /> &nbsp;<br /> <a href="https://mierda.tv/wp-content/uploads/2017/05/escenario.bmp"><img src="https://mierda.tv/wp-content/uploads/2017/05/escenario.bmp" alt="" width="640" height="480" class="alignnone size-full wp-image-2625" /></a><br /> &nbsp;<br /> &nbsp;<br /> <a href="https://mierda.tv/wp-content/uploads/2017/05/personaje.bmp"><img src="https://mierda.tv/wp-content/uploads/2017/05/personaje.bmp" alt="" width="672" height="156" class="alignnone size-full wp-image-2626" /></a><br /> &nbsp;<br /> &nbsp;<br /> Si has descargado el zip y lo has descomprimido podrás compilar el código ejecutando make en el directorio en el que se encuentra mostrarimagen.c (directorio en el que estará también el makefile).<br /> &nbsp;<br /> &nbsp;<br /> Se que no es común encontrar un bmp transparente pero &#8230; es posible crear bmps con fondo transparente y por eso quería probar si con SDL se podría jugar un poco y animar un sprite.<br /> He bajado un sprite del juego Day of the tentacle. El sprite es basicamente una secuencia de los diferentes frames que podemos usar para que parezca que el personaje está andando. En este caso son 6.<br /> &nbsp;<br /> &nbsp;<br /> Para saber cuanto tiene de ancho un frame de ese sprite <strong>tenemos que dividir entre 6 el ancho total</strong><br /> &nbsp;<br /> &nbsp;<br /> <img src="https://mierda.tv/wp-content/uploads/2017/05/sprite-bernard.png" alt="" width="2240" height="750" class="alignnone size-full wp-image-2631" srcset="https://mierda.tv/wp-contenido/uploads/2017/05/sprite-bernard.png 2240w, https://mierda.tv/wp-contenido/uploads/2017/05/sprite-bernard-300x100.png 300w, https://mierda.tv/wp-contenido/uploads/2017/05/sprite-bernard-768x257.png 768w, https://mierda.tv/wp-contenido/uploads/2017/05/sprite-bernard-1024x343.png 1024w, https://mierda.tv/wp-contenido/uploads/2017/05/sprite-bernard-820x275.png 820w" sizes="(max-width: 2240px) 100vw, 2240px" /><br /> &nbsp;<br /> &nbsp;<br /> Dejo aquí el código para ver si se entiende lo realizado:<br /> &nbsp;<br /> &nbsp;</p><pre>
#include &ltSDL.h&gt
#include &ltstdio.h&gt

int main(void) {
	SDL_Window * ventana;
	SDL_Renderer * render;

	SDL_Surface * imagenEscenario;		// Escenario
	SDL_Texture * texturaEscenario;		// Escenario
	SDL_Surface * imagenPersonaje;          // Personaje
	SDL_Texture * texturaPersonaje;         // Personaje
	int x = 0;
	int y = 324;				// 480  de alto del escenario - 112 del alto del personaje son 324.
	int s = 20;				// los pixeles que avanzará el personae a cada paso.
	int alturaPersonaje = 112;		// la altura del frame del personaje.
	int anchuraPersonaje = 156;		// la anchura del frame del personaje.

        SDL_Rect srcrect1 = { 0, 0, alturaPersonaje, anchuraPersonaje };	// frame1 del personaje
        SDL_Rect srcrect2 = { 112, 0, alturaPersonaje, anchuraPersonaje };	// frame2 del personaje
        SDL_Rect srcrect3 = { 224, 0, alturaPersonaje, anchuraPersonaje };	// frame3 del personaje
        SDL_Rect srcrect4 = { 336, 0, alturaPersonaje, anchuraPersonaje };	// frame4 del personaje
        SDL_Rect srcrect5 = { 448, 0, alturaPersonaje, anchuraPersonaje };	// frame5 del personaje
        SDL_Rect srcrect6 = { 560, 0, alturaPersonaje, anchuraPersonaje };	// frame6 del personaje

        imagenEscenario = SDL_LoadBMP("res/escenario.bmp");	// Cargamos el bmp del escenario. El fondo.
        imagenPersonaje = SDL_LoadBMP("res/personaje.bmp");	// Cargamos el sprite para extraer todos los frames


        SDL_Init(SDL_INIT_VIDEO);
        ventana = SDL_CreateWindow("mostrando una imagen",SDL_WINDOWPOS_UNDEFINED,SDL_WINDOWPOS_UNDEFINED,640,480,SDL_WINDOW_OPENGL);
        if (ventana == NULL) {
                printf("No se pudo crear la ventana: %s\n", SDL_GetError());
                return 1;
        }

        render = SDL_CreateRenderer(ventana, -1, 0);

        texturaEscenario = SDL_CreateTextureFromSurface(render, imagenEscenario);
        texturaPersonaje = SDL_CreateTextureFromSurface(render, imagenPersonaje);


	// Cargamos el escenario
	SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
	SDL_RenderPresent(render);

	// Cargamos el personaje en el frame 1
        SDL_Rect dstrect1 = { x, y, alturaPersonaje, anchuraPersonaje };
	SDL_RenderCopy(render, texturaPersonaje, &srcrect1, &dstrect1);
	SDL_RenderPresent(render);

        SDL_Delay(250);

	// Cargamos el personaje en el frame 2
        SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
        SDL_RenderPresent(render);
        x = x+s;
        SDL_Rect dstrect2 = { x, y, alturaPersonaje, anchuraPersonaje };
        SDL_RenderCopy(render, texturaPersonaje, &srcrect2, &dstrect2);
        SDL_RenderPresent(render);

        SDL_Delay(250);

	// Cargamos el personaje en el frame 3
        SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
        SDL_RenderPresent(render);
        x = x+s;
        SDL_Rect dstrect3 = { x, y, alturaPersonaje, anchuraPersonaje };
        SDL_RenderCopy(render, texturaPersonaje, &srcrect3, &dstrect3);
        SDL_RenderPresent(render);

        SDL_Delay(250);

	// Cargamos el personaje en el frame 4
        SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
        SDL_RenderPresent(render);
        x = x+s;
        SDL_Rect dstrect4 = { x, y, alturaPersonaje, anchuraPersonaje };
        SDL_RenderCopy(render, texturaPersonaje, &srcrect4, &dstrect4);
        SDL_RenderPresent(render);

        SDL_Delay(250);

	// Cargamos el personaje en el frame5
        SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
        SDL_RenderPresent(render);
        x = x+s;
        SDL_Rect dstrect5 = { x, y, alturaPersonaje, anchuraPersonaje };
        SDL_RenderCopy(render, texturaPersonaje, &srcrect5, &dstrect5);
        SDL_RenderPresent(render);

        SDL_Delay(250);

	// Cargamos el personaje en el frame6
        SDL_RenderCopy(render, texturaEscenario, NULL, NULL);
        SDL_RenderPresent(render);
        x = x+s;
        SDL_Rect dstrect6 = { x, y, alturaPersonaje, anchuraPersonaje };
        SDL_RenderCopy(render, texturaPersonaje, &srcrect6, &dstrect6);
        SDL_RenderPresent(render);

        SDL_Delay(3000);


	SDL_DestroyTexture(texturaEscenario);
	SDL_FreeSurface(imagenEscenario);
        SDL_DestroyTexture(texturaPersonaje);
        SDL_FreeSurface(imagenPersonaje);

	SDL_DestroyRenderer(render);
	SDL_DestroyWindow(ventana);

        SDL_Quit();
        return 0;
}
</pre><p>&nbsp;<br /> &nbsp;</p><p>Para que se entienda mejor y no tener que añadir código de control de eventos he ido poniendo cada frame con una espera de 250ms (un cuarto de segundo) seguidos. Se puede ver en el código todo lo que ya hemos visto en anteriores artículos.<br /> &nbsp;<br /> &nbsp;<br /> <img src="https://mierda.tv/wp-content/uploads/2017/05/sprite3.gif" alt="" width="320" height="222" class="alignnone size-full wp-image-2619" /><br /> &nbsp;<br /> &nbsp;<br /> <strong>Lo nuevo es que en vez de una imagen vemos que podemos añadir una sobre otra.</strong> Por ejemplo si fuéramos mala gente seguramente quedriamos crearnos un programa que añadiese una mascara de agua a una foto. pues con esto ya sabríamos hacerlo (al menos para sobreponer 2 imágenes). Para guardar se necesitarían otras funciones.<br /> &nbsp;<br /> &nbsp;<br /> Esto no incorpora mucho más a lo que ya hemos visto, no obstante <strong>es bueno saber que podemos coger solamente una parte de un mapa de bits y mostrarla donde queramos</strong>. Es por eso que quería realizar este ejemplo.<br /> &nbsp;<br /> &nbsp;<br /> Para no liar demasiado en vez de crear un bucle he preferido simplemente colocarlo todo secuencialmente.<br /> &nbsp;<br /> &nbsp;<br /> Es bueno darse también cuenta de que en un programa de verdad tendríamos que estar ya realizando funciones y trabajar en diferentes archivos para que fuese algo más modular y reutilizable.<br /> &nbsp;<br /> &nbsp;<br /> Pero no son programas de verdad, de momento son ejemplos para ir viendo que cosas se pueden hacer con SDL programando en C sobre GNU/Linux.<br /> &nbsp;<br /> &nbsp;<br /> Saludos cordiales.</p><div class='rp4wp-related-posts'><h3>Más mierda posiblemente relacionada</h3><ul><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2016/09/01/montar-imagenes-dfh-sobre-gnulinux/'>Montar imágenes DFH y ADF sobre GNU/Linux.</a><p>Montar una imagen de disco en formato FFS (Fast File System). Los discos duros para&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2018/06/27/recopilacion-programar-juegos-con-sdl-en-c/'>Recopilación - Programar juegos con SDL en C</a><p>En 2017 me entró la vena de programar en C algunos juegos y de paso&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2016/09/01/abrir-y-editar-imagenes-graficas-iff-en-gnulinux/'>Abrir y editar imágenes IFF en GNU/Linux</a><p>IFF-ILBM es un formato de imagen que fue popular en los tiempos de oro del&hellip;</p></div></li></ul></div></div><div class="meta bottom section-inner"><p class="tags"> #<a href="https://mierda.tv/tag/animacion/" rel="tag">animación</a> #<a href="https://mierda.tv/tag/c/" rel="tag">c</a> #<a href="https://mierda.tv/tag/gnu/" rel="tag">gnu</a> #<a href="https://mierda.tv/tag/linux/" rel="tag">linux</a> #<a href="https://mierda.tv/tag/sdl/" rel="tag">sdl</a> #<a href="https://mierda.tv/tag/sprite/" rel="tag">sprite</a> #<a href="https://mierda.tv/tag/tutorial/" rel="tag">tutorial</a></p></div><div class="post-pagination section-inner"><div class="previous-post"> <a href="https://mierda.tv/2017/05/02/sdl-en-c-bajo-gnulinux-003-mostrando-una-imagen/" rel="prev"><span>SDL en C bajo GNU/Linux 003 &#8211; Mostrando una imagen</span></a></div><div class="next-post"> <a href="https://mierda.tv/2017/05/02/convertir-un-video-a-gif-y-optimizar-este-luego/" rel="next"><span>Convertir un vídeo a gif y optimizar este luego</span></a></div></div><div class="section-inner wide"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Deja un comentario <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2017/05/02/sdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion/#respond" style="display:none;">Cancelar respuesta</a></small></h3><form action="https://mierda.tv/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comentario</label><textarea autocomplete="nope"  id="90378b2472"  name="90378b2472"   cols="45" rows="8" maxlength="65525" required="required"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="nope" style="padding:0;clip:rect(1px, 1px, 1px, 1px);position:absolute !important;white-space:nowrap;height:1px;width:1px;overflow:hidden;" tabindex="-1"></textarea><script type="text/javascript">document.getElementById("comment").setAttribute( "id", "64729b4d6d29653ba50a54b501484645" );document.getElementById("90378b2472").setAttribute( "id", "comment" );</script></p><p class="comment-form-author"><label for="author">Nombre <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p><p class="comment-form-email"><label for="email">Correo electrónico <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p><p class="comment-form-url"><label for="url">Web</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Publicar comentario" /> <input type='hidden' name='comment_post_ID' value='2617' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p></form></div></div></div><footer class="site-footer section-inner"><p class="copyright">&copy; 2018 <a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></p></footer></main> <script type="text/javascript">jQuery(document).ready( function() { jQuery.post( "https://mierda.tv/wp-admin/admin-ajax.php", { action : "entry_views", _ajax_nonce : "70537a5d8f", post_id : 2617 } ); } );</script> <script type='text/javascript'>var es_widget_page_notices = {"es_email_notice":"Por favor introduce direcci\u00f3n de correo electr\u00f3nico","es_success_message":"Suscripci\u00f3n correcta.","es_success_notice":"\u00a1Suscripci\u00f3n correcta! Consulta tu bandeja de entrada y confirma tu suscripci\u00f3n. Si no ves el correo en unos minutos, consulta la carpeta spam\/correo no deseado.","es_email_exists":"\u00a1Esa direcci\u00f3n de correo electr\u00f3nico ya existe!","es_error":"Ups. Ha sucedido un error inesperado.","es_invalid_email":"Direcci\u00f3n de correo electr\u00f3nico no v\u00e1lida","es_try_later":"Por favor, int\u00e9ntalo transcurridos unos minutos","es_ajax_url":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript'>var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"year\":\"2017\",\"monthnum\":\"05\",\"day\":\"02\",\"name\":\"sdl-en-c-bajo-gnulinux-004-varias-imagenes-y-animacion\"}"};</script> <script type="text/javascript" defer src="https://mierda.tv/wp-contenido/cache/autoptimize/js/autoptimize_0f440c40192207511c15447e1fc97710.js"></script></body></html>