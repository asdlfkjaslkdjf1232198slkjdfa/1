<!DOCTYPE html><html class="no-js" lang="es-ES"><head><meta http-equiv="content-type" content="text/html" charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" ><link rel="profile" href="http://gmpg.org/xfn/11"><link type="text/css" media="all" href="https://mierda.tv/wp-contenido/cache/autoptimize/css/autoptimize_dcbc99a7d03052a28dbf604173960da0.css" rel="stylesheet" /><title>Bloquear respuestas ICMP &#8211; echo reply &#8211; [ MIERDA TV ]</title><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Feed" href="https://mierda.tv/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; RSS de los comentarios" href="https://mierda.tv/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Bloquear respuestas ICMP &#8211; echo reply RSS de los comentarios" href="https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/feed/" /><link rel='stylesheet' id='mcluhan-fonts-css'  href='https://fonts.googleapis.com/css?family=Archivo:400,400i,600,600i,700,700i&#038;subset=latin-ext' type='text/css' media='all' /> <script type='text/javascript' src='https://mierda.tv/wp-includes/js/jquery/jquery.js'></script> <link rel='https://api.w.org/' href='https://mierda.tv/wp-json/' /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mierda.tv/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mierda.tv/wp-includes/wlwmanifest.xml" /><link rel='prev' title='Amule 2.3.2' href='https://mierda.tv/2017/02/26/amule-2-3-2/' /><link rel='next' title='Vitetris &#8211; Tetris multiplayer para l칤nea de comandos' href='https://mierda.tv/2017/03/12/vitetris-tetris-multiplayer-para-linea-de-comandos/' /><meta name="generator" content="WordPress 4.9.8" /><link rel="canonical" href="https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/" /><link rel='shortlink' href='https://mierda.tv/?p=2188' /><link rel="alternate" type="application/json+oembed" href="https://mierda.tv/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmierda.tv%2F2017%2F03%2F02%2Fbloquear-respuestas-icmp-echo-reply%2F" /> <script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script> <link rel="icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon-1.png" type="image/png"/><link rel="shortcut icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon.png" /></head><body class="post-template-default single single-post postid-2188 single-format-standard"><header class="site-header group"><h1 class="site-title"><a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></h1><p class="site-description">NSFW Fanta text files</p><div class="nav-toggle"><div class="bar"></div><div class="bar"></div></div><div class="menu-wrapper"><ul class="main-menu desktop"><li id="menu-item-9007" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li id="menu-item-9006" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li id="menu-item-9008" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li id="menu-item-9012" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li id="menu-item-9011" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li id="menu-item-9010" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li></ul></div><ul class="social-menu desktop"><li><a href="https://mierda.tv/?s="></a></li><li id="menu-item-10588" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscr칤bete al Bolet칤n mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscr칤bete al Bolet칤n mensual de Mierda.tv</span></a></li></ul></header><div class="mobile-menu-wrapper"><ul class="main-menu mobile"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li><li class="toggle-mobile-search-wrapper"><a href="#" class="toggle-mobile-search">Buscar</a></li></ul><ul class="social-menu mobile"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscr칤bete al Bolet칤n mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscr칤bete al Bolet칤n mensual de Mierda.tv</span></a></li></ul></div><div class="mobile-search"><div class="untoggle-mobile-search"></div><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab60e8b0d7d"> <span class="screen-reader-text">B칰squeda para:</span> </label> <input type="search" id="search-form-5bab60e8b0d7d" class="search-field" placeholder="Introduce tu b칰squeda" value="" name="s" autocomplete="off" /> </button></form><div class="mobile-results"><div class="results-wrapper"></div></div></div><div class="search-overlay"><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab60e8b0e13"> <span class="screen-reader-text">B칰squeda para:</span> </label> <input type="search" id="search-form-5bab60e8b0e13" class="search-field" placeholder="Introduce tu b칰squeda" value="" name="s" autocomplete="off" /> </button></form></div><main class="site-content"><article class="post-2188 post type-post status-publish format-standard hentry category-sistemas tag-icmp tag-ping missing-thumbnail"><header class="entry-header section-inner"><h1 class="entry-title">Bloquear respuestas ICMP &#8211; echo reply</h2><div class="meta"> <time><a href="https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/" title="2 marzo, 2017 5:58 pm">2 marzo, 2017</a></time> <span> En <a href="https://mierda.tv/category/sistemas/" rel="category tag"># SYSTEM</a> </span></div></header><div class="entry-content section-inner"><p>Para ilustrar el ejemplo de como bloquear es bueno conocer antes como funciona un poco el subprotocolo encapsulado en IP ICMP. Para ilustrarlo he optado por scapy.</p><p>En debian se puede instalar as칤:</p><p>&nbsp;</p><pre># apt-get install scapy</pre><p>&nbsp;</p><p>Abrimos nuestro editor de textos favorito (nano por ejemplo o vim o joe o emacs o el que te de la real gana) y creamos un archivo. Yo voy a usar GNU nano ya que tiene poco prestigio pero tu puedes usar otro editor con el que te sientas m치s c칩modo/a.</p><p>Creamos un archivo llamado: <strong>echo_request.py</strong></p><p>&nbsp;</p><pre>$ nano echo_request.py</pre><p>&nbsp;</p><p>Con este contenido:</p><p>&nbsp;</p><pre>from scapy.all import *
import sys

ip_target = "37.228.132.136"
data = "hola mundo"
ip = IP()
icmp = ICMP()
ip.dst = ip_target
icmp.type = 8
icmp.code = 0
sr(ip/icmp/data)</pre><p>&nbsp;</p><p>Cambiamos esa IP del target por la de la maquina que queremos que no responda a PING. <strong>Aunque inicialmente queremos que si lo haga claro.</strong></p><p>El motivo de importar scapy de esa forma es para poder usarlo tal y como lo usar칤amos en su propio interprete pero desde python.<br /> El icmp.type e icmp.code los podemos obtener del RFC correspondiente que define el protocolo pero creo se ve aqu칤 bien:</p><p>&nbsp;</p><pre>Type	Name					Reference
----	-------------------------		---------
  0	Echo Reply				 [RFC792]
  1	Unassigned				    [JBP]
  2	Unassigned				    [JBP]
  3	Destination Unreachable			 [RFC792]
  4	Source Quench			 	 [RFC792]
  5	Redirect				 [RFC792]
  6	Alternate Host Address			    [JBP]
  7	Unassigned				    [JBP]
  8	Echo					 [RFC792]
  9	Router Advertisement			[RFC1256]
 10	Router Selection			[RFC1256]
 11	Time Exceeded				 [RFC792]
 12	Parameter Problem			 [RFC792]
 13	Timestamp				 [RFC792]
 14	Timestamp Reply				 [RFC792]
 15	Information Request			 [RFC792]
 16	Information Reply			 [RFC792]
 17	Address Mask Request                     [RFC950]
 18	Address Mask Reply			 [RFC950]
 19	Reserved (for Security)			   [Solo]
 20-29	Reserved (for Robustness Experiment)	    [ZSu]
 30	Traceroute				[RFC1393]
 31	Datagram Conversion Error		[RFC1475]
 32     Mobile Host Redirect              [David Johnson]
 33     IPv6 Where-Are-You                 [Bill Simpson]
 34     IPv6 I-Am-Here                     [Bill Simpson]
 35     Mobile Registration Request        [Bill Simpson]
 36     Mobile Registration Reply          [Bill Simpson]
 37     Domain Name Request                     [Simpson]
 38     Domain Name Reply                       [Simpson]
 39     SKIP                                    [Markson]
 40     Photuris                                [Simpson]
 41-255 Reserved				    [JBP]</pre><p>&nbsp;</p><p>Para la petici칩n especificamos el 8 y para la respuesta el type 0 (<strong>aunque la respuesta nos va a dar lo mismo ya que vamos a bloquear directamente icmp type 8 de entrada</strong>)</p><p>Nos conectamos a la maquina de la IP que hemos especificado. All칤 instalamos ngrep y tcpdump as칤 por ejemplo si es una debian o derivada:</p><p>&nbsp;</p><pre># apt-get install ngrep tcpdump</pre><p>&nbsp;</p><p>En nuestra maquina tenemos el script python que tira de scapy que ser치 el que mandar치 la petici칩n ICMP echo request o echo a secas (type 8).<br /> Tendremos en otra terminal abierto <strong>tcpdump</strong> con este comando <strong>en nuestra maquina</strong>:</p><p>&nbsp;</p><pre># tcpdump -nni eth0 -e icmp[icmptype] == 0 -vv</pre><p>y con <strong>ngrep</strong> tambi칠n en nuestra maquina <strong>en otra terminal</strong>:</p><p>&nbsp;</p><pre># ngrep -d eth0 -q '.' 'icmp'

</pre><p>Donde eth0 lo cambias por tu interface.</p><p>&nbsp;</p><p>En la maquina que va a llegarle la petici칩n (la que hemos especificado en el target) hacemos lo mismo con la interface de red adecuada:</p><pre># tcpdump -nni venet0 -e icmp[icmptype] == 8 -vv
# ngrep -d venet0 -q '.' 'icmp'</pre><p>En dos terminales a ser posible. De ese modo ya podemos mandar la petici칩n que hemos creado.</p><p>&nbsp;</p><pre>$ python echo _request.py</pre><p>&nbsp;</p><p>Y veremos como funciona el tinglado. veremos como llegan las peticiones echo request y como llegan las echo reply con el contenido que hemos metido.</p><p>&nbsp;</p><p>Ante eso solo queda que en la maquina target metamos una regla de iptables:</p><p>&nbsp;</p><pre># iptables -A OUTPUT -p icmp -o venet0 -j DROP</pre><p>&nbsp;</p><p>Cambiando vnet0 por tu interface claro.</p><p>&nbsp;</p><p>Con eso si probamos de nuevo no tendr칤a que llegar petici칩n a quien la solicita, es decir, mandan un echo request y no obtienen un echo reply.</p><p>Fin de la historia.</p><div class='rp4wp-related-posts'><h3>M치s mierda posiblemente relacionada</h3><ul><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2016/11/22/comprobar-caducidad-certificados/'>Comprobar caducidad certificados</a><p>Un sencillo script para comprobar la fecha de caducidad de determinados certificados https pasando una&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2017/11/14/6-periodicos-online-con-y-sin-publicidad/'>6 peri칩dicos online con y sin publicidad</a><p>He realizado una serie de capturas de pantalla de 6 peri칩dicos online sin un servidor&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2017/08/10/bloquear-ips-de-rusia-y-china/'>Bloquear IPs de Rusia y China</a><p>O de cualquier otro pa칤s. Es un buen script creado por nixCraft que permite r치pidamente&hellip;</p></div></li></ul></div></div><div class="meta bottom section-inner"><p class="tags"> #<a href="https://mierda.tv/tag/icmp/" rel="tag">icmp</a> #<a href="https://mierda.tv/tag/ping/" rel="tag">ping</a></p></div><div class="post-pagination section-inner"><div class="previous-post"> <a href="https://mierda.tv/2017/02/26/amule-2-3-2/" rel="prev"><span>Amule 2.3.2</span></a></div><div class="next-post"> <a href="https://mierda.tv/2017/03/12/vitetris-tetris-multiplayer-para-linea-de-comandos/" rel="next"><span>Vitetris &#8211; Tetris multiplayer para l칤nea de comandos</span></a></div></div><div class="section-inner wide"><div class="comments"><h3 class="comment-reply-title">2 comentarios</h3><div class="comment even thread-even depth-1" id="li-comment-991"><div id="comment-991"><header class="comment-meta"> <span class="comment-author"> <cite> <a href='https://blog.adrianistan.eu' rel='external nofollow' class='url'>Adri치n Arroyo</a> </cite> </span> <span class="comment-date"> <a class="comment-date-link" href="https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/#comment-991" title="2 mayo, 2017 a 6:00 pm">2 mayo, 2017</a> </span> <span class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/?replytocom=991#respond' onclick='return addComment.moveForm( "comment-991", "991", "respond", "2188" )' aria-label='Responder a Adri치n Arroyo'>Contestar</a></span></header><div class="comment-content entry-content"><p>쯇ara qu칠 alguien querr칤a bloquear un echo ICMP? ICMP es un protocolo que sirve para controlar el buen funcionamiento de la red. Si tienes un equipo conectado a Internet no es recomendable bloquear ICMP y si tienes un equipo en casa&#8230; El propio router con la NAT te est치 bloqueando cualquier ICMP. En definitiva un echo ICMP solo va a decir que en esa IP tiene una interfaz de red asignada pero ni mucho menos ser칤a la 칰nica forma de saber si existe algo detr치s de esa IP (y de hecho no ser칤a lo m치s eficiente, yo por ejemplo lo har칤a usando el protocolo ARP, de nivel inferior, encargado de la traducci칩n IP a MAC), as칤 que como excusa de privacidad tampoco es 칰til bloquear el echo ICMP.</p></div><div class="comment-actions"></div></div><div class="comment byuser comment-author-mierda bypostauthor odd alt depth-2" id="li-comment-992"><div id="comment-992"><header class="comment-meta"> <span class="comment-author"> <cite> <a href='https://linuxinthenight.com/fanta' rel='external nofollow' class='url'>mierda</a> </cite> <span class="comment-by-post-author"> (Autor)</span> </span> <span class="comment-date"> <a class="comment-date-link" href="https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/#comment-992" title="2 mayo, 2017 a 10:56 pm">2 mayo, 2017</a> </span> <span class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://mierda.tv/2017/03/02/bloquear-respuestas-icmp-echo-reply/?replytocom=992#respond' onclick='return addComment.moveForm( "comment-992", "992", "respond", "2188" )' aria-label='Responder a mierda'>Contestar</a></span></header><div class="comment-content entry-content"><p>Existe gente que quiere eso 游땔 para sus servidores en sitios raros.</p></div><div class="comment-actions"></div></div></div></div></div><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Deja un comentario <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2017/03/02/bloquear-respuestas-icmp-echo-reply/#respond" style="display:none;">Cancelar respuesta</a></small></h3><form action="https://mierda.tv/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comentario</label><textarea autocomplete="nope"  id="e5a06f55ec"  name="e5a06f55ec"   cols="45" rows="8" maxlength="65525" required="required"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="nope" style="padding:0;clip:rect(1px, 1px, 1px, 1px);position:absolute !important;white-space:nowrap;height:1px;width:1px;overflow:hidden;" tabindex="-1"></textarea><script type="text/javascript">document.getElementById("comment").setAttribute( "id", "bf18a8f95d33ebc832a59d880591a57c" );document.getElementById("e5a06f55ec").setAttribute( "id", "comment" );</script></p><p class="comment-form-author"><label for="author">Nombre <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p><p class="comment-form-email"><label for="email">Correo electr칩nico <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p><p class="comment-form-url"><label for="url">Web</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Publicar comentario" /> <input type='hidden' name='comment_post_ID' value='2188' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p></form></div></div></div><footer class="site-footer section-inner"><p class="copyright">&copy; 2018 <a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></p></footer></main> <script type="text/javascript">jQuery(document).ready( function() { jQuery.post( "https://mierda.tv/wp-admin/admin-ajax.php", { action : "entry_views", _ajax_nonce : "70537a5d8f", post_id : 2188 } ); } );</script> <script type='text/javascript'>var es_widget_page_notices = {"es_email_notice":"Por favor introduce direcci\u00f3n de correo electr\u00f3nico","es_success_message":"Suscripci\u00f3n correcta.","es_success_notice":"\u00a1Suscripci\u00f3n correcta! Consulta tu bandeja de entrada y confirma tu suscripci\u00f3n. Si no ves el correo en unos minutos, consulta la carpeta spam\/correo no deseado.","es_email_exists":"\u00a1Esa direcci\u00f3n de correo electr\u00f3nico ya existe!","es_error":"Ups. Ha sucedido un error inesperado.","es_invalid_email":"Direcci\u00f3n de correo electr\u00f3nico no v\u00e1lida","es_try_later":"Por favor, int\u00e9ntalo transcurridos unos minutos","es_ajax_url":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript'>var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"year\":\"2017\",\"monthnum\":\"03\",\"day\":\"02\",\"name\":\"bloquear-respuestas-icmp-echo-reply\"}"};</script> <script type="text/javascript" defer src="https://mierda.tv/wp-contenido/cache/autoptimize/js/autoptimize_0f440c40192207511c15447e1fc97710.js"></script></body></html>