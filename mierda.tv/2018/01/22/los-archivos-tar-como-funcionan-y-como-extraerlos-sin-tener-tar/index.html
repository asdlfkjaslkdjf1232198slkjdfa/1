<!DOCTYPE html><html class="no-js" lang="es-ES"><head><meta http-equiv="content-type" content="text/html" charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" ><link rel="profile" href="http://gmpg.org/xfn/11"><link type="text/css" media="all" href="https://mierda.tv/wp-contenido/cache/autoptimize/css/autoptimize_dcbc99a7d03052a28dbf604173960da0.css" rel="stylesheet" /><title>Los archivos tar &#8211; Como funcionan y como extraerlos sin tener tar &#8211; [ MIERDA TV ]</title><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Feed" href="https://mierda.tv/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; RSS de los comentarios" href="https://mierda.tv/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Los archivos tar &#8211; Como funcionan y como extraerlos sin tener tar RSS de los comentarios" href="https://mierda.tv/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/feed/" /><link rel='stylesheet' id='mcluhan-fonts-css'  href='https://fonts.googleapis.com/css?family=Archivo:400,400i,600,600i,700,700i&#038;subset=latin-ext' type='text/css' media='all' /> <script type='text/javascript' src='https://mierda.tv/wp-includes/js/jquery/jquery.js'></script> <link rel='https://api.w.org/' href='https://mierda.tv/wp-json/' /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mierda.tv/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mierda.tv/wp-includes/wlwmanifest.xml" /><link rel='prev' title='Hola mundo en ensamblador con debug sobre dosbox' href='https://mierda.tv/2018/01/21/hola-mundo-en-ensamblador-con-debug-sobre-dosbox/' /><link rel='next' title='Comprimir y descomprimir archivos en GNU/Linux desde la línea de comandos' href='https://mierda.tv/2018/01/23/comprimir-y-descomprimir-archivos-en-gnu-linux-desde-la-linea-de-comandos/' /><meta name="generator" content="WordPress 4.9.8" /><link rel="canonical" href="https://mierda.tv/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/" /><link rel='shortlink' href='https://mierda.tv/?p=5182' /><link rel="alternate" type="application/json+oembed" href="https://mierda.tv/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmierda.tv%2F2018%2F01%2F22%2Flos-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar%2F" /> <script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script> <link rel="icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon-1.png" type="image/png"/><link rel="shortcut icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon.png" /></head><body class="post-template-default single single-post postid-5182 single-format-standard"><header class="site-header group"><h1 class="site-title"><a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></h1><p class="site-description">NSFW Fanta text files</p><div class="nav-toggle"><div class="bar"></div><div class="bar"></div></div><div class="menu-wrapper"><ul class="main-menu desktop"><li id="menu-item-9007" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li id="menu-item-9006" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li id="menu-item-9008" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li id="menu-item-9012" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li id="menu-item-9011" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li id="menu-item-9010" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li></ul></div><ul class="social-menu desktop"><li><a href="https://mierda.tv/?s="></a></li><li id="menu-item-10588" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></header><div class="mobile-menu-wrapper"><ul class="main-menu mobile"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li><li class="toggle-mobile-search-wrapper"><a href="#" class="toggle-mobile-search">Buscar</a></li></ul><ul class="social-menu mobile"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></div><div class="mobile-search"><div class="untoggle-mobile-search"></div><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab6034e9056"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab6034e9056" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form><div class="mobile-results"><div class="results-wrapper"></div></div></div><div class="search-overlay"><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab6034e90ee"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab6034e90ee" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form></div><main class="site-content"><article class="post-5182 post type-post status-publish format-standard hentry category-codigo category-sistemas missing-thumbnail"><header class="entry-header section-inner"><h1 class="entry-title">Los archivos tar &#8211; Como funcionan y como extraerlos sin tener tar</h2><div class="meta"> <time><a href="https://mierda.tv/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/" title="22 enero, 2018 6:17 pm">22 enero, 2018</a></time> <span> En <a href="https://mierda.tv/category/codigo/" rel="category tag"># CODE</a>, <a href="https://mierda.tv/category/sistemas/" rel="category tag"># SYSTEM</a> </span></div></header><div class="entry-content section-inner"><p>Los archivos tar se diseñaron para utilizarse en cintas de copias. Básicamente son bloques de 512k uno tras otro siguiendo este patrón:</p><p>&#8211; <strong>cabecera</strong> archivo1 [512]<br /> &#8211; contenido archivo1 [512]<br /> &#8211; contenido archivo1 [512]<br /> &#8211; contenido archivo1 [512]<br /> &#8211; <strong>cabecera</strong> archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; contenido archivo2 [512]<br /> &#8211; <strong>cabecera</strong> archivo3 [512]<br /> &#8211; contenido archivo3 [512]<br /> &#8211; <strong>cabecera</strong> archivo4 [512]<br /> &#8211; contenido archivo4 [512]<br /> &#8211; contenido archivo4 [512]<br /> &#8211; &#8230;</p><p>Como puede verse el contenido irá en bloques de 512k tras la cabecera (tambien de 512k) del archivo que se empaqueta. En la cabecera se añade el tamaño del archivo de modo que este puede ocupar más o menos bloques de 512 tras la cabecera. Si el tamaño del archivo es menor de 512k entonces ocupará el contenido solamente 1 bloque, si es más grande pues va ocupando más bloques dejando con valores nulos lo sobrante.</p><p><strong>Los archivos tar suelen verse con extensión &#8220;tar&#8221; y se usa normalmente la herramienta &#8220;tar&#8221; para empaquetar y desempaquetar.</strong><br /> Se trata de un standard de formato de archivo muy utilizado en el mundo GNU/Linux y lo veremos con extensiones como por ejemplo tar.gz ya que aparte de empaquetarse luego se comprimen en gzip por ejemplo.<br /> <strong><br /> Hagamos una prueba </strong>de como empaquetar (sin comprimir) 5 archivos que generamos para la ocasión:</p><pre>
$ mkdir archivostar
$ cd archivostar
$ echo "hola mundo 1" > hola1.txt
$ echo "hola mundo 2" > hola2.txt
$ echo "hola mundo 3" > hola3.txt
$ echo "hola mundo 4" > hola4.txt
$ echo "hola mundo 5" > hola5.txt
$ tar cf hola.tar hola1.txt hola2.txt hola3.txt hola4.txt hola5.txt 
</pre><p>Obtendremos un nuevo archivo llamado hola.tar que es el que contiene el resto de archivos en su interior.</p><p>Este script realizado en un par de horas puede servir para conocer cuantos archivos contiene un tar y que nombre tienen.</p><pre>
#!/bin/bash

file=$1
blockhead=512
dblock=1024
position=0

for i in $(seq 1 100);
do
        xxd -s $position -g 1 -l 100 -c 100 $file | rev | cut -d " " -f 1 | rev
        let positionsize=position+124
        sizefile=$(printf "%d" $(dd skip=$positionsize count=12 bs=1 status=none if="$file" | hexdump -e '12/1 "%c"'))

        if [[ $sizefile -lt 512 ]]
        then
                let position=dblock+position
        else
                rbf=$(echo "($sizefile/$blockhead)" | bc)
                resto=$(echo "$sizefile%512" | bc)
                #resto=$((10#$resto))
                if [[ $resto -eq 0 ]]
                then
                        let position=blockhead+position+sizefile
                else
                        ns=$(echo "($rbf*$blockhead)" | bc)
                        let position=blockhead+position+ns+blockhead
                fi
        fi

done
</pre><p><strong>Ese mismo script en bash puede modificarse para extraer los archivos sin mucha dificultad, es decir, podemos utilizarlo si no tenemos tar en algún entorno.</strong></p><p>Sigamos viendo como funciona el tema.</p><p><strong>Cabecera de un tar:</strong></p><pre>
filename [100]
mode [8]
uid [8]
gid [8]
fileSize [12]
lastModification [12]
checksum [8]
typeFlag [1]
linkedFileName [100]
ustarIndicator [6]
ustarVersion [2]
ownerUserName [32]
ownerGroupName [32]
deviceMajorNumber [8]
deviceMinorNumber [8] 
filenamePrefix [155]
padding [12]
</pre><p>Usando dd podemos extraer los datos de la cabecera de por ejemplo el archivo1:</p><pre>
dd skip=0 count=100 bs=1 status=none if=hola.tar | hexdump -e '100/1 "%c" "\n"'
dd skip=100 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=108 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=116 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=124 count=12 bs=1 status=none if=hola.tar | hexdump -e '12/1 "%c" "\n"'
dd skip=136 count=12 bs=1 status=none if=hola.tar | hexdump -e '12/1 "%c" "\n"'
dd skip=148 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=156 count=1 bs=1 status=none if=hola.tar | hexdump -e '1/1 "%c" "\n"'
dd skip=157 count=100 bs=1 status=none if=hola.tar | hexdump -e '100/1 "%c" "\n"'
dd skip=257 count=6 bs=1 status=none if=hola.tar | hexdump -e '6/1 "%c" "\n"'
dd skip=263 count=2 bs=1 status=none if=hola.tar | hexdump -e '2/1 "%c" "\n"'
dd skip=265 count=32 bs=1 status=none if=hola.tar | hexdump -e '32/1 "%c" "\n"'
dd skip=297 count=32 bs=1 status=none if=hola.tar | hexdump -e '32/1 "%c" "\n"'
dd skip=329 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=337 count=8 bs=1 status=none if=hola.tar | hexdump -e '8/1 "%c" "\n"'
dd skip=345 count=155 bs=1 status=none if=hola.tar | hexdump -e '155/1 "%c" "\n"'
dd skip=500 count=12 bs=1 status=none if=hola.tar | hexdump -e '12/1 "%c" "\n"'
</pre><p><strong>La mayoría de datos estarán en octal y tendremos que convertirlos si queremos entenderlos.</strong></p><p>Explicación de que contenidos extraemos:</p><p><strong>filename</strong><br /> dd skip=0 count=100 bs=1 status=none if=hola.tar | hexdump -e &#8216;100/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>mode (644 por ejemplo. en octal. stat hola.tar para verlo y ver tambien el uid y gid)</strong><br /> dd skip=100 count=8 bs=1 status=none if=hola.tar | hexdump -e &#8216;8/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>uid (El valor en octal. 1750 por ejemplo son 1000 en decimal. &#8220;id -u user&#8221; para ver el uid del usuario.</strong><br /> dd skip=108 count=8 bs=1 status=none if=hola.tar | hexdump -e &#8216;8/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>gid (El valor en octal. 1750 por ejemplo son 100 en decimal. &#8220;id -g user&#8221; para ver el gid del usuario.</strong><br /> dd skip=116 count=8 bs=1 status=none if=hola.tar | hexdump -e &#8216;8/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>filesize (El valor en octal. 14 = 13 bytes. du -b hola1.txt para ver su tamaño por ejemplo)</strong><br /> dd skip=124 count=12 bs=1 status=none if=hola.tar | hexdump -e &#8217;12/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>lastModification (EL valor en octal se pasa a decimal y se obtiene el tiempo Epoch &#8211; tiempo unix. Podemos convertirlo:  echo &#8220;13231210625&#8221; | date)</strong><br /> dd skip=136 count=12 bs=1 status=none if=hola.tar | hexdump -e &#8217;12/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>checksum (este tiene miga y paso de comentarlo.)</strong><br /> dd skip=148 count=8 bs=1 status=none if=hola.tar | hexdump -e &#8216;8/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p><strong>typeFlag (1 byte. Mirar typeFlag lista de valores posibles)</strong><br /> dd skip=156 count=1 bs=1 status=none if=hola.tar | hexdump -e &#8216;1/1 &#8220;%c&#8221; &#8220;\n&#8221;&#8216;</p><p>Y así con todos veremos que obtenemos el valor en octal. Sobre typeFlag aquí una chuleta de los valores posibles que tendriamos que obtener (en octal y luego lo pasamos a decimal):</p><pre>
typeFlag

'0' or (ASCII NUL) 	Normal file
'1' 	Hard link
'2' 	Symbolic link
'3' 	Character special
'4' 	Block special
'5' 	Directory
'6' 	FIFO
'7' 	Contiguous file
'g' 	global extended header with meta data (POSIX.1-2001)
'x' 	extended header with meta data for the next file in the archive (POSIX.1-2001)
'A'–'Z' 	Vendor specific extensions (POSIX.1-1988)
All other values 	reserved for future standardization
</pre><p><strong>Links de interés por si andas deseando crear un programa que empaquete y desempaquete archivos tar: </strong></p><ul><li><a href="https://en.wikipedia.org/wiki/Tar_%28computing%29">https://en.wikipedia.org/wiki/Tar_%28computing%29</a></li><li><a href="https://www.mkssoftware.com/docs/man4/tar.4.asp">https://www.mkssoftware.com/docs/man4/tar.4.asp</a></li><li><a href="https://techoverflow.net/2013/03/29/reading-tar-files-in-c/">https://techoverflow.net/2013/03/29/reading-tar-files-in-c/</a></li></ul><p><strong>Nota:</strong> Si la cinta de backup se paraba o terminaba no perdías todo ya que como vemos esto se almacena linealmente. Siempre puedes recuperar los últimos x archivos que se han grabado ya que van en bloques de 512k.</p><div class='rp4wp-related-posts'><h3>Más mierda posiblemente relacionada</h3><ul><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2018/01/14/lua-concatenar-2-archivos/'>Lua - Concatenar 2 archivos</a><p>En una anterior entrada se ha visto un ejemplo de código en Lua que nos&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2018/01/24/tarbomb-archivos-fuera-del-directorio-de-trabajo/'>Tarbomb - Archivos fuera del directorio de trabajo</a><p>No confundir esto con "decompression bomb". Esto al descomprimir nos llena el disco o nos&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2018/01/24/analisis-velocidad-compresion-tar-gz-tar-bz2-y-tar-xz/'>Análisis - Velocidad/compresión tar.gz, tar.bz2 y tar.xz</a><p>En anteriores posts se ha hablado de lo que es un tar por dentro y&hellip;</p></div></li></ul></div></div><div class="post-pagination section-inner"><div class="previous-post"> <a href="https://mierda.tv/2018/01/21/hola-mundo-en-ensamblador-con-debug-sobre-dosbox/" rel="prev"><span>Hola mundo en ensamblador con debug sobre dosbox</span></a></div><div class="next-post"> <a href="https://mierda.tv/2018/01/23/comprimir-y-descomprimir-archivos-en-gnu-linux-desde-la-linea-de-comandos/" rel="next"><span>Comprimir y descomprimir archivos en GNU/Linux desde la línea de comandos</span></a></div></div><div class="section-inner wide"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Deja un comentario <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/#respond" style="display:none;">Cancelar respuesta</a></small></h3><form action="https://mierda.tv/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comentario</label><textarea autocomplete="nope"  id="a50b1b5dc0"  name="a50b1b5dc0"   cols="45" rows="8" maxlength="65525" required="required"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="nope" style="padding:0;clip:rect(1px, 1px, 1px, 1px);position:absolute !important;white-space:nowrap;height:1px;width:1px;overflow:hidden;" tabindex="-1"></textarea><script type="text/javascript">document.getElementById("comment").setAttribute( "id", "feb7e0cf005a037c7fea6f2114a78958" );document.getElementById("a50b1b5dc0").setAttribute( "id", "comment" );</script></p><p class="comment-form-author"><label for="author">Nombre <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p><p class="comment-form-email"><label for="email">Correo electrónico <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p><p class="comment-form-url"><label for="url">Web</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Publicar comentario" /> <input type='hidden' name='comment_post_ID' value='5182' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p></form></div></div></div><footer class="site-footer section-inner"><p class="copyright">&copy; 2018 <a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></p></footer></main> <script type="text/javascript">jQuery(document).ready( function() { jQuery.post( "https://mierda.tv/wp-admin/admin-ajax.php", { action : "entry_views", _ajax_nonce : "70537a5d8f", post_id : 5182 } ); } );</script> <script type='text/javascript'>var es_widget_page_notices = {"es_email_notice":"Por favor introduce direcci\u00f3n de correo electr\u00f3nico","es_success_message":"Suscripci\u00f3n correcta.","es_success_notice":"\u00a1Suscripci\u00f3n correcta! Consulta tu bandeja de entrada y confirma tu suscripci\u00f3n. Si no ves el correo en unos minutos, consulta la carpeta spam\/correo no deseado.","es_email_exists":"\u00a1Esa direcci\u00f3n de correo electr\u00f3nico ya existe!","es_error":"Ups. Ha sucedido un error inesperado.","es_invalid_email":"Direcci\u00f3n de correo electr\u00f3nico no v\u00e1lida","es_try_later":"Por favor, int\u00e9ntalo transcurridos unos minutos","es_ajax_url":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript'>var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"year\":\"2018\",\"monthnum\":\"01\",\"day\":\"22\",\"name\":\"los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar\"}"};</script> <script type="text/javascript" defer src="https://mierda.tv/wp-contenido/cache/autoptimize/js/autoptimize_0f440c40192207511c15447e1fc97710.js"></script></body></html>