<!DOCTYPE html><html class="no-js" lang="es-ES"><head><meta http-equiv="content-type" content="text/html" charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" ><link rel="profile" href="http://gmpg.org/xfn/11"><link type="text/css" media="all" href="https://mierda.tv/wp-contenido/cache/autoptimize/css/autoptimize_dcbc99a7d03052a28dbf604173960da0.css" rel="stylesheet" /><title>Tarbomb &#8211; Archivos fuera del directorio de trabajo &#8211; [ MIERDA TV ]</title><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Feed" href="https://mierda.tv/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; RSS de los comentarios" href="https://mierda.tv/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="[ MIERDA TV ] &raquo; Tarbomb &#8211; Archivos fuera del directorio de trabajo RSS de los comentarios" href="https://mierda.tv/2018/01/24/tarbomb-archivos-fuera-del-directorio-de-trabajo/feed/" /><link rel='stylesheet' id='mcluhan-fonts-css'  href='https://fonts.googleapis.com/css?family=Archivo:400,400i,600,600i,700,700i&#038;subset=latin-ext' type='text/css' media='all' /> <script type='text/javascript' src='https://mierda.tv/wp-includes/js/jquery/jquery.js'></script> <link rel='https://api.w.org/' href='https://mierda.tv/wp-json/' /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mierda.tv/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mierda.tv/wp-includes/wlwmanifest.xml" /><link rel='prev' title='Comprimir y descomprimir archivos en GNU/Linux desde la línea de comandos' href='https://mierda.tv/2018/01/23/comprimir-y-descomprimir-archivos-en-gnu-linux-desde-la-linea-de-comandos/' /><link rel='next' title='Zip of Death &#8211; Bombas que te llenan el disco duro' href='https://mierda.tv/2018/01/24/zip-of-death-bombas-que-te-llenan-el-disco-duro/' /><meta name="generator" content="WordPress 4.9.8" /><link rel="canonical" href="https://mierda.tv/2018/01/24/tarbomb-archivos-fuera-del-directorio-de-trabajo/" /><link rel='shortlink' href='https://mierda.tv/?p=5292' /><link rel="alternate" type="application/json+oembed" href="https://mierda.tv/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmierda.tv%2F2018%2F01%2F24%2Ftarbomb-archivos-fuera-del-directorio-de-trabajo%2F" /> <script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script> <link rel="icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon-1.png" type="image/png"/><link rel="shortcut icon" href="https://mierda.tv/wp-contenido/uploads/2017/12/favicon.png" /></head><body class="post-template-default single single-post postid-5292 single-format-standard"><header class="site-header group"><h1 class="site-title"><a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></h1><p class="site-description">NSFW Fanta text files</p><div class="nav-toggle"><div class="bar"></div><div class="bar"></div></div><div class="menu-wrapper"><ul class="main-menu desktop"><li id="menu-item-9007" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li id="menu-item-9006" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li id="menu-item-9008" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li id="menu-item-9012" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li id="menu-item-9011" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li id="menu-item-9010" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li></ul></div><ul class="social-menu desktop"><li><a href="https://mierda.tv/?s="></a></li><li id="menu-item-10588" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></header><div class="mobile-menu-wrapper"><ul class="main-menu mobile"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-9007"><a href="https://mierda.tv/category/sistemas/"># SYSTEM</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9006"><a href="https://mierda.tv/category/codigo/"># CODE</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9008"><a href="https://mierda.tv/category/juegos/"># GAMES</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9012"><a href="https://mierda.tv/category/3d/"># 3D</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9011"><a href="https://mierda.tv/category/musica/"># MUSIC</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9010"><a href="https://mierda.tv/category/opinion/"># VIEW</a></li><li class="toggle-mobile-search-wrapper"><a href="#" class="toggle-mobile-search">Buscar</a></li></ul><ul class="social-menu mobile"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10588"><a title="Suscríbete al Boletín mensual de Mierda.tv" href="https://mierda.tv/suscribete-al-boletin-mensual-de-mierda-tv/"><span class="screen-reader-text">Suscríbete al Boletín mensual de Mierda.tv</span></a></li></ul></div><div class="mobile-search"><div class="untoggle-mobile-search"></div><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab6033da549"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab6033da549" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form><div class="mobile-results"><div class="results-wrapper"></div></div></div><div class="search-overlay"><form role="search" method="get" class="search-form" action="https://mierda.tv/"> <label for="search-form-5bab6033da5df"> <span class="screen-reader-text">Búsqueda para:</span> </label> <input type="search" id="search-form-5bab6033da5df" class="search-field" placeholder="Introduce tu búsqueda" value="" name="s" autocomplete="off" /> </button></form></div><main class="site-content"><article class="post-5292 post type-post status-publish format-standard hentry category-sistemas missing-thumbnail"><header class="entry-header section-inner"><h1 class="entry-title">Tarbomb &#8211; Archivos fuera del directorio de trabajo</h2><div class="meta"> <time><a href="https://mierda.tv/2018/01/24/tarbomb-archivos-fuera-del-directorio-de-trabajo/" title="24 enero, 2018 1:19 am">24 enero, 2018</a></time> <span> En <a href="https://mierda.tv/category/sistemas/" rel="category tag"># SYSTEM</a> </span></div></header><div class="entry-content section-inner"><p>No confundir esto con &#8220;decompression bomb&#8221;. Esto al descomprimir nos llena el disco o nos deja sin inodes. La finalidad es escribir fuera del directorio de trabajo que se supone para descomprimir un tar o tar.gz o meter enlaces simbolicos con la esperanza de que enlacen a archivos de sistema y cambien los permisos del archivo (por ejemplo si en un README se les incita a ello).</p><p>Comenzamos.</p><p>Para examinar el contenido de un archivo tar o tar.gz:</p><pre>
$ tar tfv paquete.tar
$ tar tfv paquete.tar
</pre><p>Podemos ver en esta captura como al crear un tar nos elimina la barra de /tmp/archivo1.txt</p><p><img src="https://mierda.tv/wp-contenido/uploads/2018/01/tar-elimina-barra.png" alt="" width="1051" height="239" class="alignnone size-full wp-image-5294" /></p><p>En esta imagen podemos ver &#8220;/&#8221; que se corresponde a 47 en decimal (2F en hexadecimal)</p><p><img src="https://mierda.tv/wp-contenido/uploads/2018/01/asciifull.gif" alt="" width="494" height="488" class="alignnone size-full wp-image-5296" /></p><p>De modo que con un editor hexadecimal podríamos añadir la / a un archivo y guardar. Esto no es tan sencillo como parece de modo que mejor usar el argumento -P que nos permite tar.</p><p>Las versiones más modernas de tar comprueban esto pero podemos saltarlo usando P. Por ejemplo así para crearlo:</p><pre>
$ tar cfvP paquete.tar /tmp/archivo1.txt archivo1.txt archivo2.txt archivo3.txt
/tmp/archivo1.txt
archivo1.txt
archivo2.txt
archivo3.txt
</pre><p>Y así para descomprimirlo:</p><pre>
$ tar xfvP paquete.tar
</pre><p>Si nos fijamos nos estamos saltando con P la comprobación y el tar descomprimirá en el directorio de trabajo archivo1.txt, archivo2.txt y archivo3.txt pero también en /tmp/archivo1.txt</p><p><strong>Digamos que si no se sabe bien como descomprimir un tar.gz no nos fiemos nunca de quienes nos digan que usemos la opción P mayúscula.</strong> Digamos que si yo pongo aquí que te bajes un tar.gz y te indico que uses -P en los argumentos podrías estar descomprimiendo archivos en rutas fuera del directorio de trabajo y eso es peligroso si usamos por ejemplo tar como root. Evidentemente si el archivo existe aunque esté fuera de la ruta del directorio de trabajo nos pedirá confirmación. <strong>Tar también tiene un argumento para sobreescribir sin solicitar confirmación de modo que cuidadin con que comandos usáis sin mirar o si usáis una versión muy vieja de tar.</strong></p><p><strong>Otros hacks posibles con enlaces simbólicos y enlaces duros:</strong></p><p>El typeflag de la cabecera que añade tar al empaquetar cada archivo contendrá si es un archivo normal, un enlace duro, un enlace simbólico, &#8230; (puedes ver como funciona un tar <a href="https://mierda.tv/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/">aquí</a>).</p><pre>
'0' or (ASCII NUL) 	Normal file
'1' 	Hard link
'2' 	Symbolic link
</pre><p>Esto nos permite por ejemplo añadir al tar enlaces duros y enlaces blandos (enlaces físicos y enlaces simbólicos).</p><p><strong>El peligro de añadir enlaces blandos</strong> es por ejemplo que el enlace si el archivo al que enlaza existe pues <strong>si por ejemplo le cambiamos los permisos cambiarán en el archivo enlazado</strong>. Esto puede suponer un problema de que sin darnos cuenta estemos cambiando los permisos de un archivo de sistema. Lo bueno es que si borramos el enlace no borramos el archivo al que enlaza.</p><p>Los enlaces blandos de todos modos cantarán si se hace un ls -la por ejemplo.</p><p>Con los enlaces duros la casualidad de que enlacen al mismo inode es prácticamente muy complicado (aunque puedes probar suerte). los enlaces duros si el archivo existe da lo mismo, es decir, no enlazará al mismo inodo de modo que aunque alteremos un enlace duro que apuntaba en nuestra maquina al inodo 3242309 pues no creo que enlace al mismo inodo.</p><p>De modo que si quieres generar un tar o tar.gz con enlaces prueba con los enlaces blandos y aunque si el usuario borra esos archivos no se borrarán los otros es posible que consigas que cambien los permisos si andan como root.</p><p>En fin. <strong>Esas son varias putadillas que pueden hacerse</strong>. Con tar por tanto mucho cuidado de saber como descomprimimos algo, done lo hacemos y si somos root o un usuario normal del sistema.</p><p>No usar por tanto P al descomprimir y comprimir evitará bastantes problemas. Comprobar los enlaces de los archivos (con stat o ls -lai) también ayuda a ver si nos están tratando de molestar.</p><p><strong>Un posible uso maligno es crear un tar.gz para que escriba en /home/usuario/.bashrc un alias que por ejemplo al escribir ls pues haga un rm ya tu sabes.</strong></p><div class='rp4wp-related-posts'><h3>Más mierda posiblemente relacionada</h3><ul><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2018/01/22/los-archivos-tar-como-funcionan-y-como-extraerlos-sin-tener-tar/'>Los archivos tar - Como funcionan y como extraerlos sin tener tar</a><p>Los archivos tar se diseñaron para utilizarse en cintas de copias. Básicamente son bloques de&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2016/11/07/proteger-directorio-con-nginx/'>Proteger directorio con Nginx</a><p>Por ejemplo si tenemos un aplicativo que tiene una zona admin en un directorio llamado&hellip;</p></div></li><li><div class='rp4wp-related-post-content'> <a href='https://mierda.tv/2016/08/03/empaquetar-un-directorio-en-volumenes/'>Empaquetar un directorio en volúmenes</a><p>Empaquetar un directorio en volúmenes de 950Mb tar -cv dir/ | split -b 950MB -&hellip;</p></div></li></ul></div></div><div class="post-pagination section-inner"><div class="previous-post"> <a href="https://mierda.tv/2018/01/23/comprimir-y-descomprimir-archivos-en-gnu-linux-desde-la-linea-de-comandos/" rel="prev"><span>Comprimir y descomprimir archivos en GNU/Linux desde la línea de comandos</span></a></div><div class="next-post"> <a href="https://mierda.tv/2018/01/24/zip-of-death-bombas-que-te-llenan-el-disco-duro/" rel="next"><span>Zip of Death &#8211; Bombas que te llenan el disco duro</span></a></div></div><div class="section-inner wide"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Deja un comentario <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/01/24/tarbomb-archivos-fuera-del-directorio-de-trabajo/#respond" style="display:none;">Cancelar respuesta</a></small></h3><form action="https://mierda.tv/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comentario</label><textarea autocomplete="nope"  id="dd165e9806"  name="dd165e9806"   cols="45" rows="8" maxlength="65525" required="required"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="nope" style="padding:0;clip:rect(1px, 1px, 1px, 1px);position:absolute !important;white-space:nowrap;height:1px;width:1px;overflow:hidden;" tabindex="-1"></textarea><script type="text/javascript">document.getElementById("comment").setAttribute( "id", "054718c99021ea818dbc1c83d99f5335" );document.getElementById("dd165e9806").setAttribute( "id", "comment" );</script></p><p class="comment-form-author"><label for="author">Nombre <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p><p class="comment-form-email"><label for="email">Correo electrónico <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p><p class="comment-form-url"><label for="url">Web</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Publicar comentario" /> <input type='hidden' name='comment_post_ID' value='5292' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p></form></div></div></div><footer class="site-footer section-inner"><p class="copyright">&copy; 2018 <a href="https://mierda.tv" class="site-name">[ MIERDA TV ]</a></p></footer></main> <script type="text/javascript">jQuery(document).ready( function() { jQuery.post( "https://mierda.tv/wp-admin/admin-ajax.php", { action : "entry_views", _ajax_nonce : "70537a5d8f", post_id : 5292 } ); } );</script> <script type='text/javascript'>var es_widget_page_notices = {"es_email_notice":"Por favor introduce direcci\u00f3n de correo electr\u00f3nico","es_success_message":"Suscripci\u00f3n correcta.","es_success_notice":"\u00a1Suscripci\u00f3n correcta! Consulta tu bandeja de entrada y confirma tu suscripci\u00f3n. Si no ves el correo en unos minutos, consulta la carpeta spam\/correo no deseado.","es_email_exists":"\u00a1Esa direcci\u00f3n de correo electr\u00f3nico ya existe!","es_error":"Ups. Ha sucedido un error inesperado.","es_invalid_email":"Direcci\u00f3n de correo electr\u00f3nico no v\u00e1lida","es_try_later":"Por favor, int\u00e9ntalo transcurridos unos minutos","es_ajax_url":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript'>var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/mierda.tv\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"year\":\"2018\",\"monthnum\":\"01\",\"day\":\"24\",\"name\":\"tarbomb-archivos-fuera-del-directorio-de-trabajo\"}"};</script> <script type="text/javascript" defer src="https://mierda.tv/wp-contenido/cache/autoptimize/js/autoptimize_0f440c40192207511c15447e1fc97710.js"></script></body></html>